SELECT * from emp order by deptno;
--1
SELECT ename,sal, 
row_number() over (order by sal desc) salbacknumber, 
row_number() over (order by sal asc) salnumber, 
rank() over (order by sal asc) salrank, 
dense_rank() over (order by sal asc) saldenserank
from emp;-- order by sal asc;
--2
select ename,sal, round(100*ratio_to_report(SAL) OVER (),2) as salshare from emp;
--3
select ename,deptno,job,hiredate,sal, sum(sal) over (partition by deptno, job order by hiredate desc) as sum_sal from emp;
--4
select ename, deptno, sal, rank() over(partition by deptno order by sal desc) num from emp e;
--fetch next 2 rows only;
--5
select ename,deptno, sal, avg(sal) over(partition by deptno order by sal rows 3 preceding) num from emp;
--6
select ename,deptno, hiredate,sal,
case
when (sal>nvl(lag(sal,2) over (order by hiredate),0)) then '>'
when (sal<nvl(lag(sal,2) over (order by hiredate),0)) then '<'
else '=' end num
from emp;
--7
SELECT deptno, listagg(job,', ') within group (order by job) JOBS from (select deptno, job from emp group by deptno, job) group BY DEPTNO;
--8
SELECT ename, sal from emp order by sal desc
fetch next 2 rows with ties;